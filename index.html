<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Tra cứu dữ liệu</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 40px;
}
h2 {
  margin-bottom: 10px;
}
input {
  padding: 8px;
  width: 300px;
  margin-bottom: 15px;
}
table {
  border-collapse: collapse;
  width: 100%;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}
th {
  background-color: #f2f2f2;
}
</style>
</head>

<body>

<h2>Tra cứu dữ liệu</h2>

<input
  type="text"
  id="searchInput"
  placeholder="Nhập từ khóa để tra cứu..."
  onkeyup="filterTable()"
/>

<table id="dataTable"></table>

<script>
/* ===== THÔNG TIN GOOGLE SHEETS ===== */
const SHEET_ID = "16AtA5daIKPlcjDUtnR20ndh6UhQlOdhx";
const SHEET_NAME = "Sheet1";   // TÊN TAB (đúng tuyệt đối)

/* ===== KHÔNG SỬA PHẦN DƯỚI ===== */
const url = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;
let originalData = [];

fetch(url)
  .then(res => res.json())
  .then(data => {
    originalData = data;
    renderTable(data);
  })
  .catch(() => {
    document.getElementById("dataTable").innerHTML =
      "<tr><td>Không tải được dữ liệu</td></tr>";
  });

function renderTable(data) {
  const table = document.getElementById("dataTable");
  table.innerHTML = "";

  if (data.length === 0) {
    table.innerHTML = "<tr><td>Không có dữ liệu</td></tr>";
    return;
  }

  // Header
  const headerRow = document.createElement("tr");
  Object.keys(data[0]).forEach(key => {
    const th = document.createElement("th");
    th.textContent = key;
    headerRow.appendChild(th);
  });
  table.appendChild(headerRow);

  // Body
  data.forEach(row => {
    const tr = document.createElement("tr");
    Object.values(row).forEach(value => {
      const td = document.createElement("td");
      td.textContent = value;
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });
}

function filterTable() {
  const keyword = document
    .getElementById("searchInput")
    .value
    .toLowerCase();

  const filtered = originalData.filter(row =>
    Object.values(row).some(value =>
      String(value).toLowerCase().includes(keyword)
    )
  );

  renderTable(filtered);
}
</script>

</body>
</html>